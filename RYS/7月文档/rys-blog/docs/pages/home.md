<!--
 * @Author: your name
 * @Date: 2020-07-02 14:26:02
 * @LastEditTime: 2020-07-03 17:46:42
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: /rys-blog/docs/pages/home.md
--> 
# 移动端支付宝对接流程

## 流程

##### 用户通过手机扫描crm二维码 ➡️手机端打开待付款页面 ➡️点击支付, 进行手机验证 ➡️手机验证成功后, 调起支付宝路由页面 ➡️支付完成后, 安卓端用户会跳转到我们配置的订单已完成页面, 而ios用户需要自己切换到我们的订单页面。

#### 即：
1. 用户产生订单，前端扫码改订单的二维码或者直接打开附带有订单id的链接，再调用后端的接口
2. 后端去调用支付宝API并返回一个Form表单。
3. 前端append这个表单，并提交表单去唤醒支付宝支付，如果用户没有安装支付宝，则打开网页版。（注：对于手机浏览器唤起H5页面模式下，如果安装了支付宝却没有唤起，大部分原因是因为该浏览器不在支付宝配置的白名单中。）
4. 用户完成支付后，支付宝根据手机网站API中传入的前台回跳地址return_url自动跳转回商户页面，同时在URL请求中以Query String的形式附上支付结果。（注：ios系统中，唤起支付宝app并完成支付后不会自动跳转到浏览器或商户App，需要用户自行切回）

